# üìú LU·ªíNG X·ª¨ L√ù CH·ª®NG CH·ªà (CERTIFICATE FLOW)

## üìã M·ª§C L·ª§C
1. [T·ªïng quan h·ªá th·ªëng](#t·ªïng-quan-h·ªá-th·ªëng)
2. [C√°c lo·∫°i ch·ª©ng ch·ªâ](#c√°c-lo·∫°i-ch·ª©ng-ch·ªâ)
3. [Lu·ªìng t·ª± ƒë·ªông y√™u c·∫ßu ch·ª©ng ch·ªâ](#lu·ªìng-t·ª±-ƒë·ªông-y√™u-c·∫ßu-ch·ª©ng-ch·ªâ)
4. [Lu·ªìng sinh vi√™n y√™u c·∫ßu th·ªß c√¥ng](#lu·ªìng-sinh-vi√™n-y√™u-c·∫ßu-th·ªß-c√¥ng)
5. [Lu·ªìng admin duy·ªát v√† ph√°t h√†nh](#lu·ªìng-admin-duy·ªát-v√†-ph√°t-h√†nh)
6. [Lu·ªìng l∆∞u tr·ªØ blockchain](#lu·ªìng-l∆∞u-tr·ªØ-blockchain)
7. [Lu·ªìng x√°c th·ª±c v√† chia s·∫ª](#lu·ªìng-x√°c-th·ª±c-v√†-chia-s·∫ª)
8. [Lu·ªìng thu h·ªìi ch·ª©ng ch·ªâ](#lu·ªìng-thu-h·ªìi-ch·ª©ng-ch·ªâ)
9. [API Endpoints](#api-endpoints)

---

## üéØ T·ªîNG QUAN H·ªÜ TH·ªêNG

### Entities ch√≠nh:
1. **Credential** - Ch·ª©ng ch·ªâ ƒë√£ ƒë∆∞·ª£c ph√°t h√†nh
2. **CredentialRequest** - Y√™u c·∫ßu c·∫•p ch·ª©ng ch·ªâ (ch·ªù duy·ªát)
3. **CertificateTemplate** - Template thi·∫øt k·∫ø ch·ª©ng ch·ªâ

### Tr·∫°ng th√°i ch·ª©ng ch·ªâ (Status):
- `Pending` - Ch·ªù duy·ªát (m·ªõi t·∫°o request)
- `Approved` - ƒê√£ duy·ªát (ch∆∞a ph√°t h√†nh)
- `Issued` - ƒê√£ ph√°t h√†nh
- `Revoked` - ƒê√£ thu h·ªìi

### Blockchain Integration:
- `IsOnBlockchain` - ƒê√£ l∆∞u tr√™n blockchain ch∆∞a
- `BlockchainCredentialId` - ID tr√™n smart contract
- `BlockchainTransactionHash` - Hash c·ªßa transaction
- `BlockchainStoredAt` - Th·ªùi gian l∆∞u tr√™n blockchain

---

## üìö C√ÅC LO·∫†I CH·ª®NG CH·ªà

### 1. Subject Completion (Ho√†n th√†nh m√¥n h·ªçc)
```csharp
CertificateType = "SubjectCompletion"
- SubjectId: Required
- FinalGrade: ƒêi·ªÉm cu·ªëi m√¥n
- LetterGrade: ƒêi·ªÉm ch·ªØ (A, B+, B, C+, ...)
```

**ƒêi·ªÅu ki·ªán ph√°t h√†nh:**
- Sinh vi√™n ƒë√£ c√≥ ƒëi·ªÉm Final Grade
- ƒêi·ªÉm >= 5.0 (Pass)

### 2. Roadmap Completion (Ho√†n th√†nh ch∆∞∆°ng tr√¨nh ƒë√†o t·∫°o)
```csharp
CertificateType = "RoadmapCompletion"
- StudentRoadmapId: Required
- FinalGrade: GPA t·ªïng k·∫øt
- Classification: X·∫øp lo·∫°i t·ªët nghi·ªáp
```

**ƒêi·ªÅu ki·ªán ph√°t h√†nh:**
- StudentRoadmap.Status = "Completed"
- GPA >= 5.0

**X·∫øp lo·∫°i:**
- GPA >= 9.0: First Class Honours
- GPA >= 8.0: Second Class Honours (Upper)
- GPA >= 7.0: Second Class Honours (Lower)
- GPA >= 6.0: Third Class Honours
- GPA >= 5.0: Pass

> **‚ö†Ô∏è NOTE:** Semester Completion Certificate ƒë√£ b·ªã lo·∫°i b·ªè kh·ªèi h·ªá th·ªëng.

---

## ü§ñ LU·ªíNG T·ª∞ ƒê·ªòNG Y√äU C·∫¶U CH·ª®NG CH·ªà

### 1. Auto-Request Subject Completion
**Trigger:** Khi sinh vi√™n ƒë·∫°t ƒëi·ªÉm Final Grade >= 5.0

```
Lu·ªìng x·ª≠ l√Ω:
1. H·ªá th·ªëng ki·ªÉm tra ƒëi·ªÉm Final Grade c·ªßa m√¥n h·ªçc
2. N·∫øu ƒëi·ªÉm >= 5.0 ‚Üí T·ª± ƒë·ªông t·∫°o CredentialRequest
3. Request.IsAutoGenerated = true
4. Request.Status = "Pending"
5. Ch·ªù admin approve

Code location: 
- CredentialService.AutoRequestSubjectCompletionCredentialAsync()
```

### 2. Auto-Request Roadmap Completion
**Trigger:** Khi StudentRoadmap.Status = "Completed"

```
Lu·ªìng x·ª≠ l√Ω:
1. Ki·ªÉm tra StudentRoadmap.Status = "Completed"
2. L·∫•y GPA t·ªïng k·∫øt t·ª´ Student.GPA
3. Ki·ªÉm tra GPA >= 5.0
4. X√°c ƒë·ªãnh x·∫øp lo·∫°i t·ªët nghi·ªáp
5. T·ª± ƒë·ªông t·∫°o CredentialRequest
6. Request.Status = "Pending"

Code location:
- CredentialService.AutoRequestRoadmapCompletionCredentialAsync()
```

> **‚ö†Ô∏è NOTE:** Auto-Request Semester Completion ƒë√£ b·ªã lo·∫°i b·ªè.

---

## üë®‚Äçüéì LU·ªíNG SINH VI√äN Y√äU C·∫¶U TH·ª¶ C√îNG

### POST /api/credential-requests (Student Role)

```
Input: RequestCredentialRequest
{
  "certificateType": "SubjectCompletion",  // or "RoadmapCompletion"
  "subjectId": "guid",  // required for SubjectCompletion
  "roadmapId": "guid",  // required for RoadmapCompletion
  "notes": "Y√™u c·∫ßu c·∫•p ch·ª©ng ch·ªâ ho√†n th√†nh m√¥n..."
}

Lu·ªìng x·ª≠ l√Ω:
1. X√°c th·ª±c sinh vi√™n (t·ª´ JWT token)
2. Ki·ªÉm tra ƒëi·ªÅu ki·ªán ƒë·ªß ƒë·ªÉ c·∫•p ch·ª©ng ch·ªâ:
   - SubjectCompletion: C√≥ ƒëi·ªÉm Final >= 5.0
   - RoadmapCompletion: Roadmap completed + GPA >= 5.0
3. Ki·ªÉm tra kh√¥ng c√≥ request tr√πng l·∫∑p (Pending)
4. T·∫°o CredentialRequest v·ªõi Status = "Pending"
5. Tr·∫£ v·ªÅ CredentialRequestDto

Code location:
- CredentialRequestsController.CreateCredentialRequest()
- CredentialService.RequestCredentialAsync()
```

### GET /api/students/me/credential-requests (Student)
```
Xem danh s√°ch request c·ªßa m√¨nh
- Filter theo status: Pending, Approved, Rejected
```

---

## üë®‚Äçüíº LU·ªíNG ADMIN DUY·ªÜT V√Ä PH√ÅT H√ÄNH

### 1. GET /api/credential-requests (Admin)
```
Xem t·∫•t c·∫£ requests ch·ªù duy·ªát
- Filter theo: Status, CertificateType, StudentId, IsAutoGenerated
- Pagination
```

### 2. POST /api/credential-requests/{id}/approve (Admin)
**Approve v√† ph√°t h√†nh ch·ª©ng ch·ªâ**

```
Input: ProcessCredentialRequestRequest
{
  "action": "Approve",
  "templateId": "guid",
  "adminNotes": "Approved"
}

Lu·ªìng x·ª≠ l√Ω:
1. L·∫•y CredentialRequest
2. Ki·ªÉm tra Status = "Pending"
3. Validate Template exists v√† match v·ªõi CertificateType
4. T·∫°o Credential m·ªõi:
   a. Generate unique CredentialId (s·ªë ch·ª©ng ch·ªâ)
   b. Generate VerificationHash (SHA-256)
   c. Generate ShareableUrl
   d. Set IPFS placeholder (s·∫Ω upload sau)
   e. Set Status = "Issued"
   f. ReviewedBy = admin.UserId
   g. ReviewedAt = DateTime.UtcNow
5. Update CredentialRequest.Status = "Approved"
6. L∆∞u database
7. [TODO] Upload to IPFS
8. [TODO] Store on Blockchain
9. Tr·∫£ v·ªÅ CredentialDetailDto

Code location:
- CredentialRequestsController.ApproveRequest()
- CredentialService.ProcessCredentialRequestAsync()
- CredentialService.CreateCredentialAsync()
```

### 3. POST /api/credential-requests/{id}/reject (Admin)
**T·ª´ ch·ªëi request**

```
Input: ProcessCredentialRequestRequest
{
  "action": "Reject",
  "adminNotes": "Kh√¥ng ƒë·ªß ƒëi·ªÅu ki·ªán"
}

Lu·ªìng x·ª≠ l√Ω:
1. Update CredentialRequest.Status = "Rejected"
2. Set AdminNotes
3. Kh√¥ng t·∫°o Credential
```

---

## ‚õìÔ∏è LU·ªíNG L∆ØU TR·ªÆ BLOCKCHAIN

### M·ª•c ƒë√≠ch:
- ƒê·∫£m b·∫£o t√≠nh b·∫•t bi·∫øn (immutable) c·ªßa ch·ª©ng ch·ªâ
- Cho ph√©p verify ch·ª©ng ch·ªâ ƒë·ªôc l·∫≠p
- Ch·ªëng gi·∫£ m·∫°o

### Lu·ªìng:
```
1. Credential ƒë∆∞·ª£c Issued (Status = "Issued")
2. Background job ho·∫∑c admin trigger blockchain storage:
   
   POST /api/blockchain/credentials/{credentialId}/store
   
3. BlockchainService.StoreCredentialAsync():
   a. L·∫•y th√¥ng tin credential
   b. Hash c√°c th√¥ng tin quan tr·ªçng
   c. G·ªçi smart contract: IssueCredential()
      - Input: studentAddress, ipfsHash, credentialHash
      - Return: credentialId (on-chain), transactionHash
   d. Update Credential:
      - IsOnBlockchain = true
      - BlockchainCredentialId = onChainId
      - BlockchainTransactionHash = txHash
      - BlockchainStoredAt = DateTime.UtcNow
   e. L∆∞u database

4. Verify on blockchain:
   GET /api/blockchain/credentials/{credentialId}/verify
   - Query smart contract ƒë·ªÉ verify hash
   - So s√°nh v·ªõi database
```

**Smart Contract Methods:**
```solidity
// CredentialManagement.sol
function issueCredential(
    address studentAddress,
    string memory ipfsHash,
    bytes32 credentialHash
) external returns (uint256 credentialId);

function verifyCredential(
    uint256 credentialId
) external view returns (bool isValid, bool isRevoked);

function revokeCredential(
    uint256 credentialId,
    string memory reason
) external;
```

---

## üîç LU·ªíNG X√ÅC TH·ª∞C V√Ä CHIA S·∫∫

### 1. Sinh vi√™n xem ch·ª©ng ch·ªâ c·ªßa m√¨nh
**GET /api/students/me/credentials**
```
Authorization: Bearer {student_token}

Response: List<CredentialDto>
- L·ªçc theo CertificateType
- Ch·ªâ xem ch·ª©ng ch·ªâ c·ªßa m√¨nh
```

### 2. Sinh vi√™n chia s·∫ª ch·ª©ng ch·ªâ
**GET /api/students/me/certificates/share**
```
Authorization: Bearer {student_token}

Response: List<CertificatePublicDto>
- K√®m theo QR Code (base64)
- ShareableUrl ƒë·ªÉ share cho ng∆∞·ªùi kh√°c
- Ch·ªâ share ch·ª©ng ch·ªâ ƒë√£ Issued v√† ch∆∞a Revoked
```

### 3. Download PDF
**GET /api/credentials/{id}/pdf**
```
T·∫£i PDF ch·ª©ng ch·ªâ
- Generate PDF t·ª´ template
- Render th√¥ng tin sinh vi√™n, ƒëi·ªÉm, QR code
- Return file PDF
```

### 4. Generate QR Code
**GET /api/credentials/{id}/qrcode?size=300**
```
Response: QRCodeResponse
{
  "credentialId": "guid",
  "qrCodeData": "data:image/png;base64,...",
  "size": 300,
  "shareableUrl": "https://frontend.com/certificates/verify/CERT-2024-001"
}

QR Code ch·ª©a: ShareableUrl ho·∫∑c VerificationHash
```

### 5. Public View - Ng∆∞·ªùi ngo√†i xem ch·ª©ng ch·ªâ
**GET /api/credentials/public/{id}**
```
AllowAnonymous - Kh√¥ng c·∫ßn ƒëƒÉng nh·∫≠p

Response: CertificatePublicDto
{
  "credentialNumber": "CERT-2024-001",
  "studentName": "Nguy·ªÖn VƒÉn A",
  "studentCode": "SE12345",
  "certificateType": "SubjectCompletion",
  "subjectName": "PRN212",
  "issuedDate": "2024-11-23",
  "finalGrade": 8.5,
  "letterGrade": "A",
  "isOnBlockchain": true,
  "blockchainTransactionHash": "0x123...",
  "isRevoked": false,
  "verificationStatus": "Verified",
  "publicUrl": "https://...",
  "qrCodeData": "data:image/..."
}

Use case:
- Nh√† tuy·ªÉn d·ª•ng qu√©t QR code ‚Üí Xem th√¥ng tin ch·ª©ng ch·ªâ
- Verify t√≠nh h·ª£p l·ªá tr√™n blockchain
```

### 6. Verify Credential
**POST /api/credentials/verify**
```
AllowAnonymous

Input: VerifyCredentialRequest
{
  "credentialNumber": "CERT-2024-001",
  "verificationHash": "abc123..."
}

Lu·ªìng:
1. T√¨m credential theo CredentialNumber ho·∫∑c VerificationHash
2. Ki·ªÉm tra:
   - Credential exists
   - IsRevoked = false
   - Status = "Issued"
3. N·∫øu IsOnBlockchain = true:
   - Query blockchain ƒë·ªÉ verify hash
   - So s√°nh hash on-chain vs database
4. Return CredentialVerificationDto:
   {
     "isValid": true,
     "message": "Valid certificate",
     "credential": {...},
     "verifiedAt": "2024-11-23T10:30:00Z"
   }
```

---

## ‚ùå LU·ªíNG THU H·ªíI CH·ª®NG CH·ªà

### DELETE /api/credentials/{id} (Admin Only)
**Revoke ch·ª©ng ch·ªâ**

```
Input: RevokeCredentialRequest
{
  "revocationReason": "Ph√°t hi·ªán gian l·∫≠n"
}

Lu·ªìng x·ª≠ l√Ω:
1. L·∫•y Credential
2. Update:
   - IsRevoked = true
   - Status = "Revoked"
   - RevokedBy = admin.UserId
   - RevokedAt = DateTime.UtcNow
   - RevocationReason = reason
3. N·∫øu IsOnBlockchain = true:
   - G·ªçi smart contract: RevokeCredential(blockchainCredentialId)
   - Update BlockchainTransactionHash (revoke transaction)
4. L∆∞u database
5. [Optional] G·ª≠i email th√¥ng b√°o cho sinh vi√™n

Code location:
- CredentialsController.RevokeCredential()
- CredentialService.RevokeCredentialAsync()
```

**·∫¢nh h∆∞·ªüng:**
- Ch·ª©ng ch·ªâ v·∫´n t·ªìn t·∫°i trong database
- Public view s·∫Ω hi·ªÉn th·ªã "Revoked"
- Verify s·∫Ω tr·∫£ v·ªÅ IsValid = false
- Blockchain s·∫Ω mark l√† revoked (kh√¥ng x√≥a ƒë∆∞·ª£c)

---

## üîå API ENDPOINTS

### Credentials
```http
# Admin
GET    /api/credentials                          # List all credentials
GET    /api/credentials/{id}                     # Get detail
POST   /api/credentials                          # Create manually
DELETE /api/credentials/{id}                     # Revoke
POST   /api/credentials/{id}/approve             # Approve
POST   /api/credentials/{id}/reject              # Reject

# Student
GET    /api/students/me/credentials              # My credentials
GET    /api/students/me/credentials/summary      # Statistics
GET    /api/students/{studentId}/credentials     # By student ID (Admin or self)
GET    /api/students/me/certificates/share       # Get shareable list with QR

# Operations
GET    /api/credentials/{id}/pdf                 # Download PDF
GET    /api/credentials/{id}/qrcode              # Generate QR code
GET    /api/credentials/{id}/share               # Get share info

# Public (No Auth)
GET    /api/credentials/public/{id}              # Public view
POST   /api/credentials/verify                   # Verify credential
```

### Credential Requests
```http
# Admin
GET    /api/credential-requests                  # List all requests
GET    /api/credential-requests/{id}             # Get detail
POST   /api/credential-requests/{id}/approve     # Approve ‚Üí Issue credential
POST   /api/credential-requests/{id}/reject      # Reject

# Student
POST   /api/credential-requests                  # Create request
GET    /api/students/me/credential-requests      # My requests
```

### Certificate Templates
```http
# Admin
GET    /api/certificate-templates                # List templates
GET    /api/certificate-templates/{id}           # Get detail
POST   /api/certificate-templates                # Create
PUT    /api/certificate-templates/{id}           # Update
DELETE /api/certificate-templates/{id}           # Delete
GET    /api/certificate-templates/{id}/preview   # Preview template

# Public
GET    /api/certificate-templates/samples        # Get sample templates
```

### Blockchain Integration
```http
POST   /api/blockchain/credentials/{id}/store    # Store on blockchain
GET    /api/blockchain/credentials/{id}/verify   # Verify on blockchain
POST   /api/blockchain/credentials/{id}/revoke   # Revoke on blockchain
```

---

## üìä DATABASE SCHEMA

### Credentials Table
```sql
CREATE TABLE Credentials (
    Id                      UNIQUEIDENTIFIER PRIMARY KEY,
    CredentialId            NVARCHAR(120) NOT NULL,        -- S·ªë ch·ª©ng ch·ªâ
    IPFSHash                NVARCHAR(200) NOT NULL,
    FileUrl                 NVARCHAR(500) NOT NULL,
    IssuedDate              DATETIME2 NOT NULL,
    IsRevoked               BIT NOT NULL DEFAULT 0,
    
    StudentId               UNIQUEIDENTIFIER NOT NULL,
    CertificateTemplateId   UNIQUEIDENTIFIER NOT NULL,
    
    -- Blockchain
    BlockchainTransactionHash    NVARCHAR(200),
    BlockchainStoredAt           DATETIME2,
    IsOnBlockchain               BIT NOT NULL DEFAULT 0,
    BlockchainCredentialId       BIGINT,                   -- On-chain ID
    
    -- Certificate Info
    CertificateType         NVARCHAR(50) NOT NULL,         -- SubjectCompletion, ...
    SubjectId               UNIQUEIDENTIFIER,
    SemesterId              UNIQUEIDENTIFIER,
    StudentRoadmapId        UNIQUEIDENTIFIER,
    CompletionDate          DATETIME2,
    FinalGrade              DECIMAL(5,2),
    LetterGrade             NVARCHAR(10),
    Classification          NVARCHAR(50),
    
    -- Verification
    VerificationHash        NVARCHAR(500),
    QRCodeData              NVARCHAR(MAX),
    ShareableUrl            NVARCHAR(500),
    
    -- Status & Review
    Status                  NVARCHAR(20) NOT NULL,         -- Pending, Issued, Revoked
    ReviewedBy              UNIQUEIDENTIFIER,
    ReviewedAt              DATETIME2,
    ReviewNotes             NVARCHAR(500),
    
    -- Revocation
    RevokedBy               UNIQUEIDENTIFIER,
    RevokedAt               DATETIME2,
    RevocationReason        NVARCHAR(500),
    
    -- Metrics
    ViewCount               INT NOT NULL DEFAULT 0,
    LastViewedAt            DATETIME2,
    
    -- PDF
    PdfFilePath             NVARCHAR(500),
    PdfUrl                  NVARCHAR(500),
    
    CreatedAt               DATETIME2 NOT NULL,
    UpdatedAt               DATETIME2,
    
    CONSTRAINT FK_Credentials_Students FOREIGN KEY (StudentId) 
        REFERENCES Students(Id),
    CONSTRAINT FK_Credentials_Templates FOREIGN KEY (CertificateTemplateId)
        REFERENCES CertificateTemplates(Id)
);
```

### CredentialRequests Table
```sql
CREATE TABLE CredentialRequests (
    Id                  UNIQUEIDENTIFIER PRIMARY KEY,
    StudentId           UNIQUEIDENTIFIER NOT NULL,
    CertificateType     NVARCHAR(50) NOT NULL,
    
    SubjectId           UNIQUEIDENTIFIER,
    SemesterId          UNIQUEIDENTIFIER,
    StudentRoadmapId    UNIQUEIDENTIFIER,
    
    Status              NVARCHAR(20) NOT NULL,             -- Pending, Approved, Rejected
    IsAutoGenerated     BIT NOT NULL DEFAULT 0,
    
    CompletionDate      DATETIME2,
    FinalGrade          DECIMAL(5,2),
    LetterGrade         NVARCHAR(10),
    Classification      NVARCHAR(50),
    
    StudentNotes        NVARCHAR(500),
    AdminNotes          NVARCHAR(500),
    ProcessedBy         UNIQUEIDENTIFIER,
    ProcessedAt         DATETIME2,
    
    CreatedAt           DATETIME2 NOT NULL,
    UpdatedAt           DATETIME2
);
```

---

## üîÑ WORKFLOW SUMMARY

### Lu·ªìng ho√†n ch·ªânh t·ª´ ƒë·∫ßu ƒë·∫øn cu·ªëi:

```
1. SINH VI√äN HO√ÄN TH√ÄNH M√îN H·ªåC
   ‚îî‚îÄ> Grade.Score (Final) >= 5.0
       ‚îî‚îÄ> Auto-generate CredentialRequest
           ‚îî‚îÄ> Status = "Pending"

2. ADMIN DUY·ªÜT
   ‚îî‚îÄ> GET /api/credential-requests (xem danh s√°ch)
       ‚îî‚îÄ> POST /api/credential-requests/{id}/approve
           ‚îî‚îÄ> T·∫°o Credential
               ‚îú‚îÄ> Generate CredentialId
               ‚îú‚îÄ> Generate VerificationHash
               ‚îú‚îÄ> Generate ShareableUrl
               ‚îú‚îÄ> Status = "Issued"
               ‚îî‚îÄ> Save to database

3. BLOCKCHAIN STORAGE (Background job ho·∫∑c manual)
   ‚îî‚îÄ> POST /api/blockchain/credentials/{id}/store
       ‚îú‚îÄ> Upload metadata to IPFS
       ‚îú‚îÄ> Call smart contract: IssueCredential()
       ‚îî‚îÄ> Update: IsOnBlockchain = true

4. SINH VI√äN XEM V√Ä CHIA S·∫∫
   ‚îú‚îÄ> GET /api/students/me/credentials (xem danh s√°ch)
   ‚îú‚îÄ> GET /api/credentials/{id}/pdf (download PDF)
   ‚îú‚îÄ> GET /api/credentials/{id}/qrcode (l·∫•y QR code)
   ‚îî‚îÄ> GET /api/students/me/certificates/share (chia s·∫ª)

5. NG∆Ø·ªúI NGO√ÄI VERIFY
   ‚îú‚îÄ> Qu√©t QR code ‚Üí ShareableUrl
   ‚îú‚îÄ> GET /api/credentials/public/{id} (xem public)
   ‚îî‚îÄ> POST /api/credentials/verify (verify hash)
       ‚îî‚îÄ> Query blockchain ƒë·ªÉ confirm

6. THU H·ªíI (n·∫øu c·∫ßn)
   ‚îî‚îÄ> DELETE /api/credentials/{id}
       ‚îú‚îÄ> Update: IsRevoked = true
       ‚îî‚îÄ> Call smart contract: RevokeCredential()
```

---

## üé® UI/UX FLOWS

### M√†n h√¨nh Admin - Qu·∫£n l√Ω Requests
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üîî Credential Requests (15 Pending)         ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Filter: [All Types ‚ñº] [Pending ‚ñº] [Search] ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                             ‚îÇ
‚îÇ ‚úì Auto  Nguy·ªÖn VƒÉn A - PRN212              ‚îÇ
‚îÇ         Subject Completion | GPA: 8.5      ‚îÇ
‚îÇ         Created: 2024-11-20                ‚îÇ
‚îÇ         [Approve] [Reject] [View Details]  ‚îÇ
‚îÇ                                             ‚îÇ
‚îÇ ‚úì Auto  Tr·∫ßn Th·ªã B - Semester 1/2024       ‚îÇ
‚îÇ         Semester Completion | GPA: 7.8     ‚îÇ
‚îÇ         Created: 2024-11-21                ‚îÇ
‚îÇ         [Approve] [Reject] [View Details]  ‚îÇ
‚îÇ                                             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### M√†n h√¨nh Student - My Certificates
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üìú My Certificates (8)                      ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Filter: [All Types ‚ñº]                       ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                             ‚îÇ
‚îÇ üéì PRN212 - .NET Programming               ‚îÇ
‚îÇ    Grade: 8.5 (A) | Issued: Nov 15, 2024   ‚îÇ
‚îÇ    ‚úÖ Verified on Blockchain               ‚îÇ
‚îÇ    [Download PDF] [Share] [View QR]        ‚îÇ
‚îÇ                                             ‚îÇ
‚îÇ üéì Semester 1/2024                         ‚îÇ
‚îÇ    GPA: 7.8 (Good) | Issued: Nov 20, 2024  ‚îÇ
‚îÇ    ‚è≥ Blockchain Pending                   ‚îÇ
‚îÇ    [Download PDF] [Share] [View QR]        ‚îÇ
‚îÇ                                             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### M√†n h√¨nh Public - Certificate Verification
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ        ‚úÖ CERTIFICATE VERIFIED              ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                             ‚îÇ
‚îÇ Certificate No: CERT-2024-001               ‚îÇ
‚îÇ Student: Nguy·ªÖn VƒÉn A (SE170001)            ‚îÇ
‚îÇ Certificate: Subject Completion - PRN212    ‚îÇ
‚îÇ Grade: 8.5 (A)                             ‚îÇ
‚îÇ Issued: November 15, 2024                   ‚îÇ
‚îÇ                                             ‚îÇ
‚îÇ üîó Blockchain Status: Verified             ‚îÇ
‚îÇ Transaction: 0x123abc...                    ‚îÇ
‚îÇ                                             ‚îÇ
‚îÇ [Download Certificate PDF]                  ‚îÇ
‚îÇ                                             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üîê SECURITY & VALIDATION

### Access Control:
```csharp
// Admin only
[Authorize(Roles = "Admin")]
- Create credential manually
- Approve/Reject requests
- Revoke credentials
- View all credentials

// Student only
[Authorize(Roles = "Student")]
- Request credentials
- View own credentials
- Share own certificates

// Public (No auth)
[AllowAnonymous]
- View public certificate
- Verify credential
```

### Validation Rules:
```csharp
// CreateCredentialRequest
- Template must match CertificateType
- Student must exist
- SubjectId required for SubjectCompletion
- SemesterId required for SemesterCompletion
- RoadmapId required for RoadmapCompletion

// RequestCredentialAsync
- Student must meet completion criteria
- No duplicate pending requests
- FinalGrade must be >= 5.0

// ProcessCredentialRequestAsync
- Request must be in Pending status
- Template must be valid
```

---

## üìù NOTES & TODO

### Current Implementation:
‚úÖ Credential CRUD
‚úÖ Auto-request generation
‚úÖ Manual request by student
‚úÖ Admin approval workflow
‚úÖ PDF generation
‚úÖ QR Code generation
‚úÖ Public view
‚úÖ Verification
‚úÖ Revocation
‚úÖ Blockchain integration (partial)

### TODO:
- [ ] IPFS upload implementation
- [ ] Background job for auto-requests
- [ ] Email notifications
- [ ] Certificate PDF template engine
- [ ] Batch blockchain storage
- [ ] Analytics dashboard
- [ ] Export credentials report

---

**Document Version:** 1.0  
**Last Updated:** November 23, 2024  
**Author:** AI Assistant
